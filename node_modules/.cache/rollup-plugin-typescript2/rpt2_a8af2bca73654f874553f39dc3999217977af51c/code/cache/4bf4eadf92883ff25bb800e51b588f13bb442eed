{"code":"import { __awaiter, __generator } from \"tslib\";\r\nimport Robot from \"dingtalk-robot-sdk\";\r\nimport path from \"path\";\r\n/**\r\n *\r\n * @description 通过钉钉群发送上传结果通知\r\n */\r\nfunction notice() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var _a, stage, dd_access_token, dd_secret, config, ddrobot, stageMap, markdownTitle, markdown;\r\n        return __generator(this, function (_b) {\r\n            _a = process.argv.slice(2), stage = _a[0], dd_access_token = _a[1], dd_secret = _a[2];\r\n            console.log(\"stage,dd_access_token,dd_secret\", stage, dd_access_token, dd_secret);\r\n            if (!stage || !dd_access_token || !dd_secret) {\r\n                return [2 /*return*/];\r\n            }\r\n            config = require(path.resolve(\"./package.json\"));\r\n            ddrobot = new Robot({\r\n                // @ts-ignore\r\n                accessToken: dd_access_token,\r\n                // @ts-ignore\r\n                secret: dd_secret,\r\n            });\r\n            stageMap = {\r\n                test: '提测',\r\n                deploy: '发布',\r\n                deploy_rc: '灰度',\r\n            };\r\n            markdownTitle = (\"\" + config.name).toUpperCase() + '：' + stageMap[stage];\r\n            markdown = new Robot.Markdown()\r\n                .setTitle(markdownTitle)\r\n                .add(\"[\" + markdownTitle + \"](\" + (config.git || \"\") + \")\\n\")\r\n                .add(\"1. version\\uFF1A\" + config.version)\r\n                .add(\"2. description\\uFF1A\" + config.description);\r\n            // @ts-ignore\r\n            ddrobot.send(markdown);\r\n            return [2 /*return*/];\r\n        });\r\n    });\r\n}\r\nexport default notice;\r\n//# sourceMappingURL=notice.js.map","references":["/Users/yangyongming/GitHub/kb-open-source/ddrobot-notice/node_modules/dingtalk-robot-sdk/index.js"],"map":"{\"version\":3,\"file\":\"notice.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/core/command/notice.ts\"],\"names\":[],\"mappings\":\";AAAA,OAAO,KAAK,MAAM,oBAAoB,CAAC;AACvC,OAAO,IAAI,MAAM,MAAM,CAAC;AAExB;;;GAGG;AACH,SAAe,MAAM;;;;YAEX,KAAsC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAA1D,KAAK,QAAA,EAAE,eAAe,QAAA,EAAE,SAAS,QAAA,CAA0B;YAClE,OAAO,CAAC,GAAG,CAAC,iCAAiC,EAAC,KAAK,EAAC,eAAe,EAAC,SAAS,CAAC,CAAC;YAC/E,IAAI,CAAC,KAAK,IAAI,CAAC,eAAe,IAAI,CAAC,SAAS,EAAE;gBAC1C,sBAAO;aACV;YACK,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC,CAAC;YAEjD,OAAO,GAAG,IAAI,KAAK,CAAC;gBACtB,aAAa;gBACb,WAAW,EAAE,eAAe;gBAC5B,aAAa;gBACb,MAAM,EAAE,SAAS;aACpB,CAAC,CAAC;YACG,QAAQ,GAAG;gBACb,IAAI,EAAE,IAAI;gBACV,MAAM,EAAE,IAAI;gBACZ,SAAS,EAAE,IAAI;aAClB,CAAC;YACI,aAAa,GAAG,CAAA,KAAG,MAAM,CAAC,IAAM,CAAA,CAAC,WAAW,EAAE,GAAG,GAAG,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;YAEvE,QAAQ,GAAG,IAAI,KAAK,CAAC,QAAQ,EAAE;iBAChC,QAAQ,CAAC,aAAa,CAAC;iBACvB,GAAG,CAAC,MAAI,aAAa,WAAK,MAAM,CAAC,GAAG,IAAI,EAAE,SAAK,CAAC;iBAChD,GAAG,CAAC,qBAAc,MAAM,CAAC,OAAS,CAAC;iBACnC,GAAG,CAAC,yBAAkB,MAAM,CAAC,WAAa,CAAC,CAAC;YACjD,aAAa;YACb,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;;;;CAC1B;AAED,eAAe,MAAM,CAAC\"}","dts":{"name":"/Users/yangyongming/GitHub/kb-open-source/ddrobot-notice/dist/core/command/notice.d.ts","writeByteOrderMark":false,"text":"/**\r\n *\r\n * @description 通过钉钉群发送上传结果通知\r\n */\r\ndeclare function notice(): Promise<void>;\r\nexport default notice;\r\n"}}
